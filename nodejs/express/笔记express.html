<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
        1.express
            ----使用安装  cnpm i express -D
            特点：入门简单，做东西麻烦----依赖于回调函数
            核心----使用中间件（中间件可自己封装module，函数方法），router 
            express是非破坏式的框架，会尽量保留原生的nodejs的方法和用法
        2.koa
            ----入门麻烦，做东西简单
            ----依赖于generator/async

        3.express使用，创建服务器
            ----1.引入模块
                    const express=require('express')
            ----2.创建server的服务器  
                    let server=express()
                    server.listen(8080);
            ----3.书写请求
                ---第一个参数必须是req，然后是res
                ---浏览器可看get请求，只有表单提交才能查看post请求
                    server.get('/aaa',(req,res,next)=>{
                        console.log('jjjjjjj')
                        next()
                    })  ----请求书写get请求
                    server.post('/uploa',(req,res,next)=>{}) ----书写post请求
                    server.use('/xxx',(req,res,next)=>{})   -----请求方式不限制，get,post都行
                    ---
                    server.get((req,res,next)=>{})  ----只要是get请求，都触发
                    server.post((req,res,next)=>{}) ----只要是post请求，都触发
                    server.use((req,res,next)=>{})  ----只要是请求都触发

                    ----use()方法也可使用中间件---use(express.static())
                    ----req  获取请求信息
                    ----res  设置后台向前台发送信息
                    ----next()  是否执行下一步,路由中使用
                        ----应用场景：类似于数据验证，是否执行下一步
                                      相同的请求/a，如果没有next(),只会执行第一个
            

            ----4.书写响应内容
                    ----若无响应内容，则服务没有下一步，一直在加载
                        ---res.end()加不加无所谓哦

                    ----res.write()------不能书写数组，对象等复杂数据类型

                    ----res.send('ggggggg');*-----express中的send()都可以书写，包括数组和对象等

                    ----书写状态码设置header
                            ----res.sendStatus(404)
                            ----类似于原生的
                                res.writeHeader(404);
                                res.write('Not Found');
                                res.end();

                    server.get('/aaa',(req,res,next)=>{
                        res.write('ggggggg'); 
                        res.send([1,2,2,3])
                        res.end()
                    }) 

        4.express读取文件（使用中间件）
            ----使用express的static中间件，
                ----读取静态文件，不过是没有选择的返回文件，只要是文件都会返回
                ----关于原生nodejs中的压缩gzip，缓存304等都已解决
                ----通过server.use(中间件)的方法
                    server.use(express.static('/www'));
            ----express的方法res.sendFile();
                    ----读取文件并返回，不过是有选择的返回和读取，符合条件的才能读取并返回
                        ----例如只有管理员才能读取某文件
                    特点：只能书写绝对路径（从根目录读取），可通过path模块的path.resolve('/a.txt')方法转换路径
                            绝对路径比相对路径安全

        5.express的中间件
            作用：
                1.类似于插件，补充框架的功能
                2.流水线，带有步骤，一步一步,什么都得过这里，里面使用的是next()
                3.中间件存在顺序
                4.原理中使用的是next();
                    ---即一个nodejs中一般是加载完中间件后，才会进行下一步的操作，此时将会使用的是next();
                    ---使用body-parser的中间件，获取post请求提交的数据
                        const body=require('body-parser');
                        server.use(body.urlencoded({extended:false}));
                        server.post('/upload',(req,res,next)=>{
                            console.log(req.body)
                        })

        6.express的方法
        ---响应方法
            res.send()
            res.sendFile('a.txt')
            res.sendStatus(500)
            res.redirect('http://www.baidu.com');
                ---重定向
                ---例如将localhost:8080/a 重定向到http://www.baidu.com
                
        7。express的数据交互post,get
            get:
                ---获取前台传递的数据
                    req.query
            post:
                ---获取前台传递的数据
                    ---使用中间件body-parser获取
                        ---cnpm i body-parser -D
                        const body=require('body-parser');
                        server.use(body.urlencoded({extended:false}))
                        server.post('/upload',(req,res,next)=>{
                            console.log(req.body)
                        })
        */
    </script>
</body>
</html>